---
layout: post
title: "Google Calendar Script"
projectFolder: "proj-4"
description: "Scheduling script which pulls dates from a spreadsheet and updates or creates the events on designated Google Calendars."
date: 2016-12-20
img: filler.jpg
tag: [JavaScript, Google Spreadsheet, Google Calendar]


abstract: "During my employment at Hull Entertainment with Paint Nite and Plant Nite, I automated many tasks such as keeping the Google Calendars in sync with the Paint Nite and Plant Nite admin portal. This Google Calendar script pulls dates from a spreadsheet, that can be downloaded straight from the admin portal, and updates or creates the events on designated Google Calendars. This project required the following criteria to be met:
<ul>
<li>Parse Upcoming Events Spreadsheets
<li>Update or Create events on Google Calendar
<li>Events are on separate calendars based on their regions
</ul>
The project was modified from the customized version to act as Google Add-on for anyone to use as of October 24th, 2017."

---
<div class="post-text-bar">
	<div class="post-text container">
		
		<h1>The Process:</h1>
		<p>This script has two phases: parsing the spreadsheet, and creating or updating events on Google Calendar.
		</p>
		<h2>Parsing The Spreadsheet.</h2>
		<p>Before coding, I had to identify the possible data coming in and its importance when creating an event. In this case, there are two types of data: optional and critical. 
<br><br>Optional data are details that some but not all events may have. Optional data includes: a description, a location, and a calendar. Should no calendar be specified, the event is created on the user’s default calendar.
<br><br>Critical data are basic details necessary to create an event on a google calendar. Critical data includes: an event ID, a date, a start time, a duration or an end time, and a title. With these basic concepts in place, a spreadsheet which implements these edge cases is below.
</p>
<br><br>img here<br><br>
<p>Deciding how to handle errors was my next step. Should one or more events be invalid, that does not imply all events logged are invalid. Each event is independent, and should be logged regardless. So, this means the script needs to mark bad entries while continuing to push events to the calendar. 
</p>
{% highlight javascript %}
function main() {
  data = getSpreadsheetData();
  findTitles();
  for (var row=1;row<lastRow;row++) {
    try {                          // Try to parse event data
      getDuration(row);
      var calendar = getCalendar(row);
      setCell(title, row, null, "#c6ffc3", ""); // successful
    } catch (errorMsg) {
      setCell(title, row, null, "#ffb7ab", "Error - "+errorMsg); // error
    }
}
{% endhighlight %}

<p>Should an error arise, the script will change the cell’s background color to red, add an error message in a note, 
and then continue. Upon fixing the error and re-running the script, it will alter the background color to green and clear the note. The image below displays what the spreadsheet looks like after being run.
</p>
<br><br>img here<br><br>
<h2>Google Calendar Event Creation.</h2>
<p>Writeup is still a WIP :) </p>

	
	</div>
</div>

<div class="post-end-bar">
	<div class="post-end container">
		<div class="post-end-wrap">
			<div class="post-end-right">
				<h1>Ending Statement</h1>
				<p>
					</p>
				
			</div>
			<div class="post-end-left">
				<h1>Source Code:</h1>
				
			</div>
		</div>
		<div class="post-relatedWorks"><h2>Related Projects: </h2>Coming soon!</div>
		
	</div>
</div>